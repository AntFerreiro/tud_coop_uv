#include "tud_coop_uv/filter.hpp"

Filter::Filter()
    : m_size_filter(30.0),
      m_coeffs({0.00498902, 0.00567655, 0.00768429, 0.01092849, 0.01526534,
                0.02049766, 0.02638413, 0.03265082, 0.03900430, 0.04514569,
                0.05078516, 0.05565588, 0.05952694, 0.06221459, 0.06359114,
                0.06359114, 0.06221459, 0.05952694, 0.05565588, 0.05078516,
                0.04514569, 0.03900430, 0.03265082, 0.02638413, 0.02049766,
                0.01526534, 0.01092849, 0.00768429, 0.00567655, 0.00498902}) {
  m_input_buffer = std::vector<double>(m_size_filter, 0.0);
}

double Filter::filter(double new_value) {
  double result = 0.0;
  int i;
  m_input_buffer[0] = new_value;

  for (i = 0; i < m_size_filter; i++) {
    result += m_input_buffer[i] * m_coeffs[i];
  }

  for (i = m_size_filter - 1; i > 0; i--) {
    m_input_buffer[i] = m_input_buffer[i - 1];
  }
  return result;
}


/*
[ -9.33357754e-04  -5.87075365e-04   4.21494887e-19   1.31978794e-03
   3.90225041e-03   8.21180326e-03   1.45433263e-02   2.29368854e-02
   3.31279895e-02   4.45447439e-02   5.63555316e-02   6.75621884e-02
   7.71255748e-02   8.41044679e-02   8.77858838e-02   8.77858838e-02
   8.41044679e-02   7.71255748e-02   6.75621884e-02   5.63555316e-02
   4.45447439e-02   3.31279895e-02   2.29368854e-02   1.45433263e-02
   8.21180326e-03   3.90225041e-03   1.31978794e-03   4.21494887e-19
  -5.87075365e-04  -9.33357754e-04
*/
